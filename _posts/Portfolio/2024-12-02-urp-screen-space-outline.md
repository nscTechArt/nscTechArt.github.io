---
title: URP中的简易Translucent材质
date: 2024-12-03 09:48 +0800
categories: [Portfolio, Unity]
media_subpath: /assets/img/Portfolio/Unity/
---

项目中需要一个特定的描边效果，用于标识玩家当前选中的家具，以及提醒玩家选中的家具是否能够摆放在当前位置。此外，描边效果还需要满足以下要求：

- 仅标识选中物体的外轮廓，无需内描边，确保选中效果的简洁
- 描边结果始终在游戏画面的最上层，确保选中效果不受物体之间相互遮挡的影响

### 实现思路

思路本身比较简单：**将需要描边的物体绘制到一个单独的Texture中，对该Texture进行边缘检测，得到该物体的外轮廓，最终合成到相机的输出结果即可。**

#### 将选中物体绘制到单独的纹理中

首先，我们需要确定如何划定“选中”的物体。URP内置了*Render Objects*功能，能够依据给定的**队列**与**LayerMask**，使用重载材质对划定的物体进行绘制，本质上就是创建特定的`FilteringSettings`，然后执行`context.DrawRenderers()`。

但是在物宅空间这个项目中，程序组对于*LayerMask*有特定的使用规则，为了不影响这部分逻辑，我们可以额外给定一个参数，即*RenderingLayerMask*。在玩家选中或取消选中物体时，通过脚本会添加或删除特定的*RenderingLayerMask*，从而决定该物体是否需要描边。

此外*Render Objects*会将绘制结果直接呈现在屏幕上，而我们需要将该结果保留在一个纹理上，以便用于边缘识别。所以，我们需要自行实现一个Render Pass，通过`ConfigureTarget()`将一张纹理作为当前Pass的渲染目标。

最终得到的绘制结果如下所示：

![](20241203170825.png)

![](_20241203170738.png)

#### 边缘检测

我们将选中物体绘制到了一个单通道的纹理中，所以，我们只需要对该纹理进行基于颜色信息的边缘检测就可以得到该物体的外轮廓。这里选择经典的Sobel算法。

#### 合成

这部分就没有什么好说的了

---

### 代码
